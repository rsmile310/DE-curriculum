var w=1120,h=600,x=d3.scale.linear().range([0,w]),y=d3.scale.linear().range([0,h]),vis=d3.select("#body").append("div").attr("class","chart").style("width",w+"px").style("height",h+"px").append("svg:svg").attr("width",w).attr("height",h),partition=d3.layout.partition().value(function(t){return t.size});d3.json("./assets/data/curriculum.json",function(t){var n=vis.selectAll("g").data(partition.nodes(t)).enter().append("svg:g").attr("transform",function(t){return"translate("+x(t.y)+","+y(t.x)+")"}).on("click",a),r=w/t.dx,e=h/1;function a(t){if(t.children){r=(t.y?w-40:w)/(1-t.y),e=h/t.dx,x.domain([t.y,1]).range([t.y?40:0,w]),y.domain([t.x,t.x+t.dx]);var a=n.transition().duration(d3.event.altKey?7500:750).attr("transform",function(t){return"translate("+x(t.y)+","+y(t.x)+")"});a.select("rect").attr("width",t.dy*r).attr("height",function(t){return t.dx*e}),a.select("text").attr("transform",i).style("opacity",function(t){return t.dx*e>12?1:0}),d3.event.stopPropagation()}}function i(t){return"translate(8,"+t.dx*e/2+")"}n.append("svg:rect").attr("width",t.dy*r).attr("height",function(t){return t.dx*e}).attr("class",function(t){return t.children?"parent":"child"}),n.append("svg:text").attr("transform",i).attr("dy",".35em").style("opacity",function(t){return t.dx*e>12?1:0}).text(function(t){return t.name}),d3.select(window).on("click",function(){a(t)})});